const inputFile=document.getElementById("jsInputFile"),fakeInputFile=document.getElementById("jsFakeInput"),fileBtn=document.getElementById("fileBtn"),preview=document.getElementById("preview"),dataTransfer=new DataTransfer,generateRandomId=()=>Math.random().toString(16).slice(2),convertBlobToFile=e=>new File([e],e.name||"preview",{type:"images/*"}),deletePreview=t=>{document.getElementById(t).remove();var e=[...dataTransfer.files].findIndex(e=>e.id===t);dataTransfer.items.remove(e),inputFile.files=dataTransfer.files},paintPreview=(e,t)=>{var n=document.createElement("div"),a=(n.id=t,n.classList.add("preview"),document.createElement("img")),e=URL.createObjectURL(e),e=(a.src=e,document.createElement("div"));e.innerText="❌",e.addEventListener("click",()=>deletePreview(t)),n.append(a),n.append(e),preview.append(n)},compressedFile=async e=>{try{return await imageCompression(e,{maxSizeMB:1,maxWidthOrHeight:1280,useWebWorker:!1})}catch(e){console.log(e)}},handleChange=async e=>{var t=e.target.files;if(0<t.length)for(let e=0;e<t.length;e++){var n=generateRandomId(),a=await compressedFile(t[e]),i=convertBlobToFile(a);i.id=n,addFile(i),paintPreview(a,n)}},addFile=e=>{dataTransfer.items.add(e),inputFile.files=dataTransfer.files};fileBtn.addEventListener("click",()=>fakeInputFile.click()),fakeInputFile.addEventListener("change",handleChange);